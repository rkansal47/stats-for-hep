Search.setIndex({"docnames": ["01-intro", "02-hypothesis-testing", "03-intervals-and-limits", "main"], "filenames": ["01-intro.ipynb", "02-hypothesis-testing.ipynb", "03-intervals-and-limits.ipynb", "main.md"], "titles": ["1. Introduction to Likelihoods and Test Statistics", "2. Hypothesis Testing and Upper Limits", "3. Confidence Intervals and Limits", "Stats for HEP"], "terms": {"let": [0, 1, 2], "s": [0, 2], "take": 0, "simplest": 0, "possibl": [0, 1], "case": [0, 1, 2], "one": [0, 1, 2], "bin": [0, 1, 2, 3], "count": [0, 1, 2], "experi": [0, 1, 2], "where": [0, 1, 2], "signal": [0, 2], "region": [0, 1, 2], "we": [0, 1, 2], "expect": [0, 1, 2, 3], "event": [0, 1, 2], "b": [0, 1, 2], "background": [0, 1, 2], "The": [0, 1, 2, 3], "probabl": [0, 1, 2], "observ": [0, 2], "n": [0, 1, 2], "distribut": [0, 1, 2], "poisson": [0, 1, 2], "mean": [0, 1, 2], "p": [0, 2, 3], "poi": [0, 2], "frac": [0, 1, 2], "e": [0, 1, 2], "sinc": [0, 2], "have": [0, 1, 2], "onli": [0, 1, 2], "two": 0, "free": 0, "paramet": [0, 1, 2], "thi": [0, 1, 2, 3], "underconstrain": 0, "so": [0, 1, 2], "also": [0, 1, 2], "add": 0, "control": [0, 1, 2], "m": [0, 1, 2], "therefor": [0, 1], "combin": [0, 3], "joint": 0, "cdot": [0, 1, 2], "call": [0, 1, 2], "In": [0, 1, 2, 3], "frequentist": [0, 2, 3], "philosophi": 0, "howev": [0, 1, 2], "all": [0, 2], "etc": 0, "ar": [0, 1, 2, 3], "simpli": 0, "fix": [0, 1, 2], "valu": [0, 2, 3], "natur": 0, "henc": [0, 1, 2], "don": [0, 1, 2], "t": [0, 1, 2], "instead": [0, 1, 2], "work": [0, 2], "function": [0, 1, 2], "interest": [0, 1, 2], "nuisanc": [0, 1, 2], "given": [0, 1, 2], "l": [0, 1, 2], "importantli": 0, "To": [0, 2], "deriv": [0, 2], "would": [0, 1, 2], "us": [0, 1, 2, 3], "bay": 0, "rule": 0, "go": [0, 1], "from": [0, 1, 2], "make": [0, 1, 2], "sens": [0, 2], "world": 0, "view": 0, "re": [0, 1, 2], "stuck": 0, "nonsens": 0, "formul": 0, "For": [0, 1, 2], "better": [0, 1, 2], "explan": 0, "i": [0, 1, 2], "recommend": [0, 1, 2, 3], "section": 0, "2": [0, 2, 3], "ref": [0, 1, 2, 3], "regard": 0, "vs": 0, "bayesian": 0, "reason": [0, 1], "like": [0, 1, 2], "nick": 0, "smith": 0, "quot": [0, 1, 2], "everyon": 0, "head": 0, "hep": 0, "becaus": [0, 2], "can": [0, 1, 2], "agre": [0, 1], "prior": 0, "often": [0, 1], "more": [0, 1, 2], "conveni": 0, "consid": [0, 2], "neg": [0, 1], "log": [0, 1, 2], "ln": [0, 1, 2], "2b": 0, "goal": [0, 1], "ani": [0, 1, 2, 3], "compat": [0, 1, 2], "here": [0, 1, 3], "certain": [0, 2], "hypothesi": [0, 2, 3], "h": [0, 1, 2], "do": [0, 2, 3], "map": [0, 1], "which": [0, 1, 2], "just": [0, 1, 2], "number": [0, 1, 2], "compar": [0, 2], "against": 0, "its": 0, "under": [0, 1, 2], "problem": 0, "thu": [0, 2], "boil": 0, "down": 0, "choos": 0, "most": [0, 1], "effect": 0, "obtain": [0, 1], "particular": [0, 1, 2], "strength": [0, 2], "typic": [0, 1, 2], "lambda": [0, 1, 2], "hat": [0, 1, 2], "mle": 0, "again": [0, 1], "logarithm": 0, "ha": 0, "nice": 0, "asymptot": [0, 1, 2, 3], "form": [0, 1, 2], "ll": [0, 1, 2], "see": [0, 1, 2], "later": [0, 1, 2], "found": 0, "exampl": [0, 1, 2, 3], "set": [0, 1, 2], "0": [0, 1, 2, 3], "gener": [0, 1, 2], "requir": 0, "numer": 0, "minim": 0, "partial": 0, "solv": [0, 1, 2], "simultan": 0, "give": [0, 2], "you": [0, 1, 2], "might": [0, 1], "Or": 0, "eq": [0, 1, 2], "8": [0, 1, 2], "2s": 0, "ms": 0, "plug": 0, "back": 0, "get": [0, 1, 2], "won": [0, 1], "write": 0, "out": 0, "even": [0, 1], "simpl": [0, 1, 2, 3], "thei": [0, 3], "pain": 0, "next": [0, 1], "step": [0, 1, 2], "either": 0, "sampl": [0, 1, 2], "multipl": 0, "toi": [0, 1, 2, 3], "an": [0, 1, 2], "larg": [0, 1], "approxim": [0, 1, 2], "now": [0, 1, 2], "paus": 0, "code": [0, 2], "up": [0, 2], "what": [0, 1, 2, 3], "far": 0, "look": [0, 1, 2], "import": [0, 1, 2], "numpi": [0, 1, 2], "np": [0, 1, 2], "matplotlib": [0, 1, 2], "mpl": 0, "pyplot": [0, 1, 2], "plt": [0, 1, 2], "scipi": [0, 1, 2], "special": [0, 1], "factori": 0, "def": [0, 1, 2], "mu": [0, 1, 2], "return": [0, 1, 2], "exp": 0, "power": 0, "sb": [0, 1, 2], "10": [0, 1, 2, 3], "5": [0, 1, 2, 3], "ns": 0, "meshgrid": 0, "arang": [0, 2], "16": [0, 1, 2], "fig": [0, 1, 2], "ax": [0, 1, 2], "subplot": [0, 1, 2], "len": [0, 2], "figsiz": [0, 1, 2], "4": [0, 1, 2, 3], "enumer": [0, 1, 2], "im": 0, "pcolormesh": [0, 2], "cmap": [0, 2], "turbo": [0, 2], "norm": [0, 1, 2], "color": [0, 1, 2], "lognorm": [0, 2], "vmax": [0, 2], "set_titl": [0, 1, 2], "rf": [0, 1, 2], "set_xlabel": [0, 1, 2], "r": [0, 1, 2], "set_ylabel": [0, 1, 2], "colorbar": [0, 2], "ravel": 0, "tolist": 0, "pad": 0, "01": [0, 2], "label": [0, 1, 2], "show": [0, 1, 2], "standard": [0, 1, 2], "2d": 0, "poisson_nofactori": 0, "denomin": 0, "cancel": 0, "remov": 0, "comput": 0, "faster": 0, "log_poisson_nofactori": [0, 1, 2], "likelihood_nofactori": 0, "log_likelihood_nofactori": [0, 1, 2], "shat": [0, 1, 2], "bhat": [0, 1, 2], "bhathat": [0, 1, 2], "quadrat": [0, 1, 2], "formula": [0, 1, 2, 3], "posit": [0, 1, 2], "solut": [0, 1, 2], "sqrt": [0, 1, 2], "lambda_": 0, "none": [0, 1, 2], "option": [0, 1, 2], "demo": [0, 1, 2], "below": [0, 1, 2], "bhh": [0, 1, 2], "bh": [0, 1, 2], "els": [0, 1, 2], "2ln": [0, 1, 2], "nm": [0, 2], "11": 0, "15": [0, 2], "50": [0, 2], "40": [0, 2], "linspac": [0, 1, 2], "20": [0, 1, 2], "101": [0, 1, 2], "6": [0, 1, 2, 3], "int": [0, 1, 2], "rang": [0, 2], "legend": [0, 1, 2], "minimum": [0, 1], "note": [0, 1], "broader": 0, "due": 0, "miss": 0, "inform": 0, "about": [0, 1, 2, 3], "demonstr": [0, 2], "explicitli": 0, "emul": 0, "perfect": 0, "set_ylim": [0, 1, 2], "match": 0, "previou": [0, 2], "inde": [0, 2], "narrow": 0, "knowledg": 0, "increas": [0, 2], "decreas": 0, "uncertainti": 0, "broaden": 0, "why": 0, "want": [0, 1, 2], "constrain": 0, "them": 0, "much": [0, 1], "construct": [0, 2], "allow": [0, 2], "physic": [0, 1, 2, 3], "rather": 0, "than": [0, 1, 2], "incorpor": 0, "contraint": 0, "impos": 0, "tild": [0, 1, 2], "left": [0, 1, 2], "begin": [0, 1, 2], "arrai": [0, 1, 2], "mbox": [0, 1, 2], "geq0": [0, 1, 2], "end": [0, 1, 2], "right": [0, 1, 2], "_s": [0, 1, 2], "lambda_zero_": 0, "when": [0, 1, 2], "lambda_tilde_": 0, "x": [0, 1, 2], "convert": [0, 1, 2], "sh": 0, "neg_shat_mask": [0, 1, 2], "find": [0, 1, 2], "lam_": 0, "lam_zero": [0, 1, 2], "replac": [0, 1, 2], "t_zero_": [0, 1, 2], "t_tilde_": [0, 1, 2], "ts": [0, 1, 2], "t_zero": [0, 1, 2], "3": [0, 1, 3], "9": [0, 2], "49": 0, "colour": [0, 2], "blue": [0, 2], "orang": [0, 1, 2], "green": [0, 2], "linestyl": [0, 1, 2], "nomin": 0, "fit": [0, 3], "best": [0, 2], "though": 0, "math": 0, "sai": [0, 1, 2], "otherwis": 0, "walk": [0, 3], "through": [0, 1, 3], "associ": [0, 2], "behaviour": 0, "common": 0, "part": [0, 1, 2, 3], "over": [0, 1, 2], "defin": [1, 2], "our": [1, 2], "model": [1, 2], "likelihood": [1, 2, 3], "statist": [1, 2, 3], "quad": [1, 2], "analyt": [1, 2], "translat": [1, 2], "h_": [1, 2], "assum": 1, "simplic": 1, "whether": 1, "data": [1, 2], "support": 1, "exclud": [1, 2], "quantifi": [1, 2], "di": 1, "agreement": [1, 2], "degre": 1, "did": 1, "search": [1, 2], "higg": 1, "boson": 1, "disagre": 1, "alreadi": 1, "discuss": [1, 2, 3], "process": 1, "scalar": 1, "need": [1, 2], "know": 1, "consist": 1, "decid": 1, "recogn": 1, "alwai": [1, 2], "chanc": 1, "true": [1, 2], "type": 1, "error": 1, "fals": [1, 2], "ii": 1, "each": [1, 2], "refer": [1, 2, 3], "alpha": [1, 2], "beta": 1, "respect": [1, 2], "handi": 1, "tabl": 1, "wikipedia": 1, "befor": [1, 2], "should": [1, 2], "comfort": 1, "level": [1, 2], "1": [1, 2, 3], "although": 1, "claim": 1, "someth": 1, "crazi": 1, "new": [1, 2, 3], "particl": [1, 2], "veri": [1, 2], "sure": 1, "isn": 1, "lower": [1, 2], "times10": 1, "7": [1, 2], "explain": 1, "sever": 1, "psuedo": 1, "dataset": 1, "One": [1, 2], "complic": 1, "13": 1, "depend": 1, "matter": 1, "ticker": [1, 2], "cm": [1, 2, 3], "stat": [1, 2], "chi2": [1, 2], "warn": [1, 2], "ipython": [1, 2], "displai": [1, 2], "markdown": 1, "latex": [1, 2], "rcparam": [1, 2], "updat": [1, 2], "font": [1, 2], "size": [1, 2], "filterwarn": [1, 2], "ignor": [1, 2], "altern": [1, 2], "squeez": [1, 2], "num_toi": [1, 2], "10000": [1, 2], "100": [1, 2], "30": [1, 2], "200": 1, "1000": 1, "24": [1, 2], "accord": [1, 2], "rv": [1, 2], "hist": [1, 2], "41": [1, 2], "histtyp": [1, 2], "densiti": [1, 2], "estim": [1, 2], "doe": [1, 2], "long": 1, "suffici": 1, "kei": 1, "base": [1, 2, 3], "profil": [1, 2], "fact": 1, "doesn": [1, 2], "follow": [1, 2, 3], "chi": [1, 2], "freedom": 1, "therein": 1, "essenti": [1, 2], "thing": 1, "taylor": 1, "expand": 1, "around": 1, "04": 1, "plot": [1, 2], "pdf": [1, 2], "2_": [1, 2], "mathrm": [1, 2], "dof": [1, 2], "accur": 1, "low": 1, "maximis": [1, 2], "equiv": 1, "final": [1, 2], "ob": [1, 2], "n_ob": [1, 2], "m_ob": [1, 2], "t_ob": [1, 2], "2f": [1, 2], "07": 1, "And": [1, 2], "fall": 1, "get_toi": [1, 2], "get_p_t": [1, 2], "test_": [1, 2], "toy_": [1, 2], "via": [1, 2], "By": [1, 2], "default": [1, 2], "same": [1, 2, 3], "chang": [1, 2], "necessari": [1, 2], "get_ps_val": [1, 2], "t_tilde_ss": [1, 2], "p_val": [1, 2], "plot_p_t": [1, 2], "p_valu": [1, 2], "z": [1, 2], "p_": [1, 2], "hlim": [1, 2], "test_s_label": [1, 2], "toy_s_label": [1, 2], "fr": [1, 2], "_": [1, 2], "ylim": [1, 2], "max": [1, 2], "vline": [1, 2], "red": [1, 2], "p_label": [1, 2], "f": [1, 2], "3f": [1, 2], "1f": [1, 2], "fill_between": [1, 2], "y1": [1, 2], "pre": [1, 2], "facecolor": [1, 2], "hatch": [1, 2], "edgecolor": [1, 2], "lightgreen": [1, 2], "p_b": [1, 2], "post": [1, 2], "lightpink": [1, 2], "n_": [1, 2], "m_": [1, 2], "care": 1, "inconsist": 1, "shade": 1, "abov": [1, 2], "int_": [1, 2], "inf": [1, 2], "d": [1, 2], "reject": 1, "less": 1, "chosen": 1, "idea": [1, 2, 3], "being": 1, "were": [1, 2], "repeat": [1, 2], "measur": 1, "mani": [1, 2], "time": [1, 2], "leq": [1, 2], "exactli": 1, "intend": 1, "correspond": 1, "deviat": 1, "awai": 1, "gaussian": 1, "phi": 1, "quantil": 1, "easili": 1, "illustr": 1, "figur": 1, "taken": 1, "varphi": 1, "ppf": 1, "percent": 1, "point": [1, 2], "54": 1, "sometim": 1, "sigma": 1, "within": 1, "list": [1, 2], "goe": 1, "q_0": 1, "usual": [1, 2], "actual": 1, "h_0": [1, 2], "_0": [1, 2], "could": [1, 2], "realli": 1, "lhc": [1, 3], "still": 1, "enough": [1, 2], "too": 1, "high": [1, 2, 3], "discov": 1, "earlier": 1, "mistak": 1, "evid": 1, "todo": 1, "check": 1, "went": 1, "framework": [1, 2, 3], "vec": 1, "singl": 1, "rel": 1, "A": 1, "particularli": 1, "try": [1, 3], "beyond": 1, "interv": [1, 3], "test": [2, 3], "t_": 2, "signific": [2, 3], "machineri": 2, "extend": 2, "straightforwardli": 2, "extract": 2, "g": 2, "68": 2, "95": 2, "similar": 2, "must": 2, "contain": 2, "cover": 2, "ensur": 2, "cl": 2, "19": 2, "infti": 2, "s_": 2, "pm": 2, "scan": 2, "rh": 2, "continu": 2, "get_limit": 2, "s_scan": 2, "float": 2, "t_tilde_scan": 2, "save": 2, "t_obs_scan": 2, "p_val_scan": 2, "append": 2, "pv_cl_diff": 2, "ab": 2, "split": 2, "half": 2, "wai": 2, "half_num_": 2, "s_low": 2, "argsort": 2, "s_high": 2, "05": 2, "25": 2, "plot_2d_p_ts_": 2, "t_bin": 2, "21": 2, "t_tilde_hist": 2, "histogram": 2, "mesh": 2, "plot_pval_level": 2, "t_lim": 2, "str": 2, "t_val": 2, "zip": 2, "clb": 2, "contour": 2, "02": 2, "vmin": 2, "1e": 2, "hline": 2, "black": 2, "set_xlim": 2, "22": 2, "neyman": 2, "differ": 2, "plu": 2, "intersect": 2, "signifi": 2, "procedur": 2, "invert": 2, "along": 2, "subtleti": 2, "rememb": 2, "principl": 2, "computation": 2, "expens": 2, "practic": [2, 3], "trick": 2, "sensit": 2, "directli": 2, "boundari": 2, "modifi": 2, "q": 2, "geq": 2, "indic": 2, "q_tilde_": 2, "upper_shat_mask": 2, "plot_ts_q": 2, "12": 2, "60": 2, "As": 2, "mai": 2, "longer": 2, "behav": 2, "delta": 2, "averag": 2, "fluctuat": 2, "plot_p_ts_q": 2, "xlim": 2, "chi2pdf": 2, "halfchi2pdf": 2, "80": 2, "160": 2, "get_p_q": 2, "get_pval_q": 2, "q_tilde_ss": 2, "q_ob": 2, "get_upper_limit": 2, "q_tilde_scan": 2, "q_obs_scan": 2, "s_upper": 2, "23": 2, "shift": 2, "slightli": 2, "bound": 2, "good": 2, "introduc": [2, 3], "few": 2, "convent": 2, "relat": 2, "first": 2, "parametr": 2, "rightarrow": 2, "repres": 2, "38": 2, "other": 2, "motiv": 2, "littl": 2, "complet": 2, "domin": 2, "draw": 2, "strong": 2, "conclus": 2, "70": 2, "020": 2, "undesir": 2, "behind": 2, "avoid": 2, "both": [2, 3], "short": 2, "criterion": 2, "cfrac": 2, "sim": 2, "On": 2, "hand": 2, "explicit": 2, "integr": 2, "unlik": 2, "greater": 2, "plot_pmu_pb": 2, "t_tilde_sb": 2, "p_mu": 2, "handl": 2, "get_legend_handles_label": 2, "lorder": 2, "new_handl": 2, "new_label": 2, "t_obs_b": 2, "14": 2, "higher": 2, "second": 2, "almost": 2, "overlap": 2, "closer": 2, "noncentr": 2, "get_limits_cl": 2, "p_cls_scan": 2, "get_upper_limit_cl": 2, "q_tilde_sb": 2, "looser": 2, "conserv": 2, "confirm": 2, "had": 2, "stai": 2, "further": 2, "concept": [2, 3], "collect": 2, "seri": 3, "some": 3, "relev": 3, "energi": 3, "It": 3, "primarili": 3, "me": 3, "understand": 3, "whatev": 3, "tool": 3, "highli": 3, "read": 3, "emphasi": 3, "heavili": 3, "implement": 3, "visual": 3, "python": 3, "ultim": 3, "help": 3, "build": 3, "intuit": 3, "plan": 3, "confid": 3, "upper": 3, "limit": 3, "come": 3, "soon": 3, "zfit": 3, "glen": 3, "cowan": 3, "kyle": 3, "cranmer": 3, "eilam": 3, "gross": 3, "ofer": 3, "vitel": 3, "eur": 3, "phy": 3, "j": 3, "c": 3, "71": 3, "1554": 3, "2011": 3, "erratum": 3, "73": 3, "2501": 3, "2013": 3, "arxiv": 3, "1007": 3, "1727": 3, "doi": 3, "1140": 3, "epjc": 3, "s10052": 3, "011": 3, "european": 3, "school": 3, "267": 3, "308": 3, "2014": 3, "1503": 3, "07622": 3, "5170": 3, "cern": 3, "003": 3}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"1": 0, "introduct": 0, "likelihood": 0, "test": [0, 1], "statist": 0, "data": 0, "model": 0, "profil": 0, "ratio": 0, "maximum": 0, "estim": 0, "defin": 0, "plot": 0, "our": 0, "t_": [0, 1], "altern": 0, "summari": [0, 1, 2], "2": 1, "hypothesi": 1, "upper": [1, 2], "limit": [1, 2], "recap": [1, 2], "deriv": 1, "p": 1, "s": 1, "observ": 1, "valu": 1, "signific": 1, "signal": 1, "discoveri": 1, "3": 2, "confid": 2, "interv": 2, "cl_": 2, "method": 2, "note": 2, "stat": 3, "hep": 3, "bibliographi": 3}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinxcontrib.bibtex": 9, "sphinx": 56}})